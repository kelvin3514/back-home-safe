{"version":3,"sources":["components/Disclaimer.tsx","containers/Tutorial/index.tsx","assets/plus.svg","hooks/usePWA.ts","utils/appCheck.ts","containers/Tutorial/AddToHomeScreen.tsx","containers/Tutorial/Disclaimer.tsx","containers/Tutorial/Language.tsx","containers/Tutorial/SetupPassword.tsx"],"names":["Disclaimer","t","useTranslation","Wrapper","styled","div","steps","usePWA","useState","prompt","setState","window","matchMedia","matches","test","location","hash","hostname","isInstalled","useEffect","handleBeforeInstallPrompt","e","preventDefault","handleAppInstalled","console","log","addEventListener","removeEventListener","promptToInstall","Promise","reject","Error","AddToHomeScreen","onInstall","useCallback","AddIcon","src","plus","InstructionWrapper","InstallButtonWrapper","Button","variant","onClick","img","Language","useI18n","language","setLanguage","StyledRadioGroup","aria-label","name","value","onChange","event","target","FormControlLabel","languageType","control","Radio","label","EN","RadioGroup","SetupPassword","TextField","type","Tutorial","setFinishedTutorial","encryptTravelRecord","useTravelRecord","activeStep","setActiveStep","password","setPassword","useMemo","allStep","key","LANGUAGE","nextButtonText","component","ADD_TO_HOME_SCREEN","DISCLAIMER","SET_UP_PASSWORD","isEmpty","stepsSettings","activeStepComponent","isLastStep","length","PageWrapper","Stepper","alternativeLabel","map","Step","StepLabel","ContentWrapper","ButtonGroup","disabled","prevActiveStep","color"],"mappings":"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","file":"static/js/15.29ab1b77.chunk.js","sourcesContent":["import React from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport styled from \"styled-components\";\n\nexport const Disclaimer = () => {\n  const { t } = useTranslation();\n  return (\n    <Wrapper>\n      <p>{t(\"global:disclaimer.1\")}</p>\n      <p>{t(\"global:disclaimer.2\")}</p>\n      <p>{t(\"global:disclaimer.3\")}</p>\n    </Wrapper>\n  );\n};\n\nconst Wrapper = styled.div`\n  width: 100%;\n  text-align: center;\n\n  & p {\n    padding: 0 16px;\n    font-size: 12px;\n  }\n`;\n","import { Button, Step, StepLabel, Stepper } from \"@material-ui/core\";\nimport { TFunction } from \"i18next\";\nimport { isEmpty } from \"ramda\";\nimport React, { useMemo, useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport styled from \"styled-components\";\n\nimport { useTravelRecord } from \"../../hooks/useTravelRecord\";\nimport { AddToHomeScreen } from \"./AddToHomeScreen\";\nimport { Disclaimer } from \"./Disclaimer\";\nimport { Language } from \"./Language\";\nimport { SetupPassword } from \"./SetupPassword\";\n\nenum steps {\n  LANGUAGE = \"LANGUAGE\",\n  ADD_TO_HOME_SCREEN = \"ADD_TO_HOME_SCREEN\",\n  DISCLAIMER = \"DISCLAIMER\",\n  SET_UP_PASSWORD = \"SET_UP_PASSWORD\",\n}\n\nconst stepsSettings = ({\n  t,\n  password,\n  setPassword,\n}: {\n  t: TFunction;\n  password: string;\n  setPassword: (value: string) => void;\n}) => [\n  {\n    key: steps.LANGUAGE,\n    name: t(\"language.name\"),\n    nextButtonText: t(\"global:button.next_page\"),\n    component: <Language />,\n  },\n  {\n    key: steps.ADD_TO_HOME_SCREEN,\n    name: t(\"add_to_home_screen.name\"),\n    nextButtonText: t(\"global:button.complete\"),\n    component: <AddToHomeScreen />,\n  },\n  {\n    key: steps.DISCLAIMER,\n    name: t(\"disclaimer.name\"),\n    nextButtonText: t(\"disclaimer.accept\"),\n    component: <Disclaimer />,\n  },\n  {\n    key: steps.SET_UP_PASSWORD,\n    name: t(\"setup_password.name\"),\n    nextButtonText: !isEmpty(password)\n      ? t(\"global:button.set\")\n      : t(\"global:button.skip\"),\n    component: <SetupPassword value={password} onChange={setPassword} />,\n  },\n];\n\nconst Tutorial = ({\n  setFinishedTutorial,\n}: {\n  setFinishedTutorial: (value: boolean) => void;\n}) => {\n  const { t } = useTranslation(\"tutorial\");\n  const { encryptTravelRecord } = useTravelRecord();\n\n  const [activeStep, setActiveStep] = useState(0);\n  const [password, setPassword] = useState(\"\");\n\n  const {\n    activeStepComponent: { component, nextButtonText },\n    isLastStep,\n    allStep,\n  } = useMemo(() => {\n    const allStep = stepsSettings({ password, setPassword, t });\n\n    return {\n      allStep,\n      activeStepComponent: allStep[activeStep] || {},\n      isLastStep: activeStep === allStep.length - 1,\n    };\n  }, [activeStep, password, setPassword, t]);\n\n  const handleNext = () => {\n    if (isLastStep) {\n      !isEmpty(password) && encryptTravelRecord(password);\n      setFinishedTutorial(true);\n    } else {\n      setActiveStep((prevActiveStep) => prevActiveStep + 1);\n    }\n  };\n\n  const handleBack = () => {\n    setActiveStep((prevActiveStep) => prevActiveStep - 1);\n  };\n\n  return (\n    <PageWrapper>\n      <Stepper activeStep={activeStep} alternativeLabel>\n        {allStep.map(({ key, name }) => (\n          <Step key={key}>\n            <StepLabel>{name}</StepLabel>\n          </Step>\n        ))}\n      </Stepper>\n      <ContentWrapper>{component}</ContentWrapper>\n      <ButtonGroup>\n        <Button disabled={activeStep === 0} onClick={handleBack}>\n          {t(\"global:button.last_page\")}\n        </Button>\n        <Button variant=\"contained\" color=\"secondary\" onClick={handleNext}>\n          {nextButtonText\n            ? nextButtonText\n            : isLastStep\n            ? t(\"global:button.complete\")\n            : t(\"global:button.next_page\")}\n        </Button>\n      </ButtonGroup>\n    </PageWrapper>\n  );\n};\n\nexport default Tutorial;\n\nconst PageWrapper = styled.div`\n  width: 100%;\n  height: 100%;\n  background-color: #fff;\n  display: flex;\n  flex-direction: column;\n`;\n\nconst ContentWrapper = styled.div`\n  height: 100%;\n  overflow: auto;\n`;\n\nconst ButtonGroup = styled.div`\n  flex-shrink: 0;\n  padding: 32px 24px;\n  display: flex;\n  justify-content: space-between;\n`;\n","export default __webpack_public_path__ + \"static/media/plus.16b1f8a3.svg\";","import { useEffect, useState } from \"react\";\nimport { checkPwaInstalled } from \"../utils/appCheck\";\n\ninterface IBeforeInstallPromptEvent extends Event {\n  readonly platforms: string[];\n  readonly userChoice: Promise<{\n    outcome: \"accepted\" | \"dismissed\";\n    platform: string;\n  }>;\n  prompt(): Promise<void>;\n}\n\nexport const usePWA = () => {\n  const [prompt, setState] = useState<IBeforeInstallPromptEvent | null>(null);\n  const [isInstalled] = useState(checkPwaInstalled());\n\n  const promptToInstall = () => {\n    if (prompt) {\n      return prompt.prompt();\n    }\n    return Promise.reject(\n      new Error(\n        'Tried installing before browser sent \"beforeinstallprompt\" event'\n      )\n    );\n  };\n\n  useEffect(() => {\n    const handleBeforeInstallPrompt = (e: IBeforeInstallPromptEvent) => {\n      e.preventDefault();\n      setState(e);\n    };\n\n    const handleAppInstalled = (e: Event) => {\n      e.preventDefault();\n      console.log(\"app installed\");\n      setState(null);\n    };\n\n    window.addEventListener(\n      \"beforeinstallprompt\",\n      handleBeforeInstallPrompt as any\n    );\n\n    window.addEventListener(\"appinstalled\", handleAppInstalled);\n\n    return () => {\n      window.removeEventListener(\n        \"beforeinstallprompt\",\n        handleBeforeInstallPrompt as any\n      );\n\n      window.removeEventListener(\"appinstalled\", handleAppInstalled);\n    };\n  }, []);\n\n  return { prompt, promptToInstall, isInstalled };\n};\n","export const checkPwaInstalled = () => {\n  const isInstalled =\n    window.matchMedia(\"(display-mode: standalone)\").matches ||\n    /\\bmode=standalone\\b/.test(window.location.hash) ||\n    window.location.hostname === \"localhost\";\n\n  return isInstalled;\n};\n","import { Button } from \"@material-ui/core\";\nimport React, { useCallback } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport styled from \"styled-components\";\n\nimport plus from \"../../assets/plus.svg\";\nimport { usePWA } from \"../../hooks/usePWA\";\n\nexport const AddToHomeScreen = () => {\n  const { t } = useTranslation(\"tutorial\");\n  const { prompt, promptToInstall } = usePWA();\n\n  const onInstall = useCallback(() => {\n    if (!prompt) return;\n    promptToInstall();\n  }, [prompt, promptToInstall]);\n\n  return (\n    <Wrapper>\n      <AddIcon src={plus} />\n      <div>{t(\"add_to_home_screen.message.add_to_home_screen_first\")}</div>\n      <div>{t(\"add_to_home_screen.message.to_act_as_an_app\")}</div>\n      <InstructionWrapper>\n        <div>IOS</div>\n        <div>{t(\"add_to_home_screen.step.ios\")}</div>\n        <div>Android</div>\n        <div>{t(\"add_to_home_screen.step.android\")}</div>\n        {prompt && (\n          <InstallButtonWrapper>\n            <Button variant=\"contained\" onClick={onInstall}>\n              {t(\"global:button.install\")}\n            </Button>\n          </InstallButtonWrapper>\n        )}\n      </InstructionWrapper>\n    </Wrapper>\n  );\n};\n\nconst Wrapper = styled.div`\n  display: flex;\n  width: 100%;\n  min-height: 100%;\n  justify-content: center;\n  vertical-align: middle;\n  flex-direction: column;\n  text-align: center;\n`;\n\nconst AddIcon = styled.img`\n  width: 100px;\n  margin: 0 auto 32px auto;\n`;\n\nconst InstallButtonWrapper = styled.div`\n  margin-top: 12px;\n`;\n\nconst InstructionWrapper = styled.div`\n  font-size: 12px;\n  margin: 24px 0;\n`;\n","import React from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport styled from \"styled-components\";\n\nimport { Disclaimer as DisclaimerContent } from \"../../components/Disclaimer\";\n\nexport const Disclaimer = () => {\n  const { t } = useTranslation(\"tutorial\");\n\n  return (\n    <Wrapper>\n      <h2>{t(\"disclaimer.name\")}</h2>\n      <DisclaimerContent />\n    </Wrapper>\n  );\n};\n\nconst Wrapper = styled.div`\n  width: 100%;\n  text-align: center;\n\n  & p {\n    padding: 0 16px;\n    font-size: 12px;\n  }\n`;\n","import { FormControlLabel, Radio, RadioGroup } from \"@material-ui/core\";\nimport React from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport styled from \"styled-components\";\n\nimport { languageType } from \"../../constants/languageType\";\nimport { useI18n } from \"../../hooks/useI18n\";\n\nexport const Language = () => {\n  const { t } = useTranslation(\"tutorial\");\n  const { language, setLanguage } = useI18n();\n\n  return (\n    <Wrapper>\n      <h2>{t(\"language.name\")}</h2>\n      <StyledRadioGroup\n        aria-label=\"language\"\n        name=\"language\"\n        value={language}\n        onChange={(event) => {\n          setLanguage(event.target.value as languageType);\n        }}\n      >\n        <FormControlLabel\n          value={languageType[\"ZH-HK\"]}\n          control={<Radio />}\n          label=\"繁體中文\"\n        />\n        <FormControlLabel\n          value={languageType.EN}\n          control={<Radio />}\n          label=\"English\"\n        />\n      </StyledRadioGroup>\n    </Wrapper>\n  );\n};\n\nconst Wrapper = styled.div`\n  width: 100%;\n  text-align: center;\n\n  & p {\n    padding: 0 16px;\n    font-size: 12px;\n  }\n\n  & input {\n    text-align: center;\n  }\n`;\n\nconst StyledRadioGroup = styled(RadioGroup)`\n  &.MuiFormGroup-root {\n    display: block;\n  }\n`;\n","import { TextField } from \"@material-ui/core\";\nimport React from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport styled from \"styled-components\";\n\ntype Props = {\n  value: string;\n  onChange: (value: string) => void;\n};\n\nexport const SetupPassword = ({ value, onChange }: Props) => {\n  const { t } = useTranslation(\"tutorial\");\n\n  return (\n    <Wrapper>\n      <h2>\n        {t(\"setup_password.name\")}({t(\"global:form.optional\")})\n      </h2>\n      <p>{t(\"setup_password.message.password_usage\")}</p>\n      <TextField\n        type=\"password\"\n        value={value}\n        onChange={(e) => {\n          onChange(e.target.value);\n        }}\n      />\n    </Wrapper>\n  );\n};\n\nconst Wrapper = styled.div`\n  width: 100%;\n  text-align: center;\n\n  & p {\n    padding: 0 16px;\n    font-size: 12px;\n  }\n\n  & input {\n    text-align: center;\n  }\n`;\n"],"sourceRoot":""}