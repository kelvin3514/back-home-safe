(this["webpackJsonpback-home-safe"]=this["webpackJsonpback-home-safe"]||[]).push([[13],{475:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a,r,c=n(3),i=(n(0),n(57)),o=n(4),s=n.p+"static/media/back.7bf7a56f.svg",b=n(1),d=function(e){var t=e.name,n=e.backPath;return Object(b.jsxs)(j,{children:[n&&Object(b.jsx)(i.b,{to:n,children:Object(b.jsx)(u,{src:s})}),t]})},u=o.b.img(a||(a=Object(c.a)(["\n  height: 20px;\n  top: 14px;\n  left: 16px;\n  position: absolute;\n"]))),j=o.b.div(r||(r=Object(c.a)(["\n  color: #ffffff;\n  background-color: #12b188;\n  text-align: center;\n  line-height: 48px;\n  text-shadow: 0px 1px 2px rgba(0, 0, 0, 0.8);\n  flex-shrink: 0;\n"])))},498:function(e,t,n){"use strict";n.d(t,"a",(function(){return A}));var a,r=n(3),c=n(115),i=n.n(c),o=n(155),s=n(9),b=n(600),d=n(575),u=n(576),j=n(577),l=n(578),h=n(508),O=n(0),p=n(158),f=n(433),v=n(57),x=n(574),g=n(4),m=n(154);!function(e){e.GET_USER_MEDIA_NOT_FOUND="GET_USER_MEDIA_NOT_FOUND",e.CAMERA_ACTIVATE_ERROR="CAMERA_ACTIVATE_ERROR"}(a||(a={}));var _,E,k=function(){var e=Object(o.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!("mediaDevices"in navigator)){e.next=11;break}return e.prev=1,e.abrupt("return",navigator.mediaDevices.getUserMedia({video:t?{deviceId:t}:{facingMode:"environment"},audio:!1}));case 5:throw e.prev=5,e.t0=e.catch(1),console.log(e.t0),new Error(a.CAMERA_ACTIVATE_ERROR);case 9:e.next=12;break;case 11:throw new Error(a.GET_USER_MEDIA_NOT_FOUND);case 12:case"end":return e.stop()}}),e,null,[[1,5]])})));return function(t){return e.apply(this,arguments)}}(),w=n(1),A=function(e){var t=e.onFrame,n=e.suppressError,r=void 0!==n&&n,c=Object(f.a)("qr_reader").t,g=Object(m.b)().preferredCameraId,_=Object(O.useState)(!1),E=Object(s.a)(_,2),A=E[0],I=E[1],y=Object(O.useState)(!1),C=Object(s.a)(y,2),D=C[0],S=C[1],M=Object(O.useRef)(null),U=Object(O.useRef)(null),N=Object(x.a)((function(){var e=U.current,n=M.current;if(e&&n&&n.readyState===n.HAVE_ENOUGH_DATA){var a=e.getContext("2d");if(!a)return;e.height=n.videoHeight,e.width=n.videoWidth,a.drawImage(n,0,0,e.width,e.height);var r=a.getImageData(0,0,e.width,e.height);t&&t(r)}}),!1),F=Object(s.a)(N,2),q=F[0],G=F[1],V=Object(O.useCallback)(Object(o.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=M.current){e.next=3;break}return e.abrupt("return");case 3:return console.log("preferredCameraId",g),e.prev=4,e.next=7,k("AUTO"===g?void 0:g);case 7:if(n=e.sent){e.next=10;break}return e.abrupt("return");case 10:t.srcObject=n,t.play(),G(),e.next=27;break;case 15:e.prev=15,e.t0=e.catch(4),e.t1=e.t0.message,e.next=e.t1===a.GET_USER_MEDIA_NOT_FOUND?20:e.t1===a.CAMERA_ACTIVATE_ERROR?22:26;break;case 20:return I(!0),e.abrupt("break",27);case 22:if(!r){e.next=24;break}return e.abrupt("return");case 24:return S(!0),e.abrupt("break",27);case 26:console.log(e.t0);case 27:case"end":return e.stop()}}),e,null,[[4,15]])}))),[G,g,r]);return Object(O.useEffect)((function(){var e=M.current;return V(),function(){if(q(),e){var t=e.srcObject;if(!t)return;t.getTracks().forEach((function(e){e.stop()})),e.srcObject=null}}}),[G,q,M,V,g]),Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(R,{ref:M,playsInline:!0}),Object(w.jsx)(T,{ref:U}),Object(w.jsxs)(b.a,{open:A,keepMounted:!0,"aria-labelledby":"unsupported-device-title","aria-describedby":"unsupported-device-description",children:[Object(w.jsx)(d.a,{id:"unsupported-device-title",children:"\u4e0d\u652f\u63f4\u7684\u88dd\u7f6e"}),Object(w.jsx)(u.a,{children:Object(w.jsxs)(j.a,{id:"unsupported-device-description",children:[c("message.doesnt_support_get_user_media"),p.isIOS&&Object(w.jsx)(w.Fragment,{children:c("message.sure_above_ios_14")})]})}),Object(w.jsx)(l.a,{children:Object(w.jsx)(v.b,{to:"/",children:Object(w.jsx)(h.a,{color:"primary",children:c("button.back_home")})})})]}),Object(w.jsxs)(b.a,{open:D,keepMounted:!0,"aria-labelledby":"camera-activation-title","aria-describedby":"camera-activation-description",children:[Object(w.jsx)(d.a,{id:"camera-activation-title",children:c("dialog.cannot_open_camera.title")}),Object(w.jsx)(u.a,{children:Object(w.jsx)(j.a,{id:"camera-activation-description",children:c("dialog.cannot_open_camera.content")})}),Object(w.jsxs)(l.a,{children:[Object(w.jsx)(v.b,{to:"/",children:Object(w.jsx)(h.a,{color:"primary",children:c("button.back_home")})}),Object(w.jsx)(v.b,{to:"/cameraSetting",children:Object(w.jsx)(h.a,{color:"primary",children:c("button.camera_setting")})})]})]})]})},R=g.b.video(_||(_=Object(r.a)(["\n  /* Make video to at least 100% wide and tall */\n  min-width: 100%;\n  min-height: 100%;\n\n  /* Setting width & height to auto prevents the browser from stretching or squishing the video */\n  width: auto;\n  height: auto;\n\n  /* Center the video */\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n"]))),T=g.b.canvas(E||(E=Object(r.a)(["\n  display: none;\n"])))},602:function(e,t,n){"use strict";n.r(t);var a,r,c,i,o=n(3),s=n(9),b=n(75),d=n(148),u=n(149),j=n(0),l=n(433),h=n(11),O=n(4),p=n.p+"static/media/qrOverlay.185cc3ea.svg",f=n(475),v=n(540),x=n.n(v),g=n(498),m=n(1),_=function(e){var t=e.onDecode,n=Object(j.useCallback)((function(e){var n=x()(e.data,e.width,e.height);n&&t(n)}),[t]);return Object(m.jsx)(g.a,{onFrame:n})},E=n(59),k=n(25),w=n(37),A=n(91),R=(t.default=function(){var e=Object(l.a)("qr_reader").t,t=Object(j.useState)(null),n=Object(s.a)(t,2),a=n[0],r=n[1],c=Object(h.g)(),i=Object(k.d)().createTravelRecord,o=Object(E.b)().language;return Object(j.useEffect)((function(){if(a){var e=Object(A.b)(a);if(e&&Object(A.a)(e,o)){var t=Object(d.a)(Object(u.a)("","nameZh",e)),n=Object(d.a)(Object(u.a)("","nameEn",e));i({venueId:e.venueId,nameZh:t,nameEn:n,type:k.c.PLACE,inputType:k.b.SCAN,inTime:Object(w.a)().toISOString()}),c.push({pathname:"/confirm"})}}}),[a,c]),Object(m.jsxs)(R,{children:[Object(m.jsx)(f.a,{backPath:"/",name:e("name")}),Object(m.jsx)(y,{children:e("message.scan_qr_code")}),Object(m.jsxs)(T,{children:[Object(m.jsx)(I,{}),Object(m.jsx)(_,{onDecode:function(e){var t=e.data;t&&!Object(b.a)(t)&&(Object(A.b)(t)&&r(t))}})]})]})},O.b.div(a||(a=Object(o.a)(["\n  width: 100%;\n  height: 100%;\n  text-shadow: 0px 1px 2px rgba(0, 0, 0, 0.8);\n  display: flex;\n  flex-direction: column;\n"])))),T=O.b.div(r||(r=Object(o.a)(["\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  position: relative;\n"]))),I=O.b.div(c||(c=Object(o.a)(['\n  /* The image used */\n  background-image: url("','");\n\n  /* Full height */\n  height: 100%;\n\n  /* Center and scale the image nicely */\n  background-position: center;\n  background-repeat: no-repeat;\n  background-size: cover;\n\n  z-index: 50;\n  position: relative;\n'])),p),y=O.b.div(i||(i=Object(o.a)(["\n  position: absolute;\n  z-index: 51;\n  bottom: 20%;\n  width: 100%;\n  text-align: center;\n  color: #ffffff;\n  font-size: 16px;\n"])))}}]);
//# sourceMappingURL=13.45c1d779.chunk.js.map